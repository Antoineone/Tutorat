<!DOCTYPE html>
<html>

{% with name="Mon Profil" %}{% include "HEAD.html" %}{% endwith %}

<body>

{% include 'HEADER.html' %}

{% if info_msg %}
    <!-- Message d'information -->
    <a href="/profile/view">
        <button class="created">{{ info_msg }}</button>
    </a>
{% endif %}

<div class="bloc_page_profil">
    <!-- Infos de l'utilisateur -->
    <div class="page_profil" id="info_profil">
        <div class="bloc_profil">
            <h2>Vos informations</h2>
            <div class="profil">
                <div class="info_profil">
                    <p><strong class="G">Nom:</strong></p>
                    <p><strong class="G">Mail:</strong></p>
                    <p><strong class="G">Classe:</strong></p>
                </div>
                <div class="info_profil">
                    <p>{{ infos[0] }}</p>
                    <p>{{ infos[2] }}</p>
                    <p>{{ infos[3] }}</p>
                </div>
                <a href="/profile/update">
                    <button>Modifier</button>
                </a>
            </div>
        </div>
    </div>
    <div class="page_profil">
        <!-- Liste des offres crées par l'utilisateur -->
        <div class="offres">
            <h2>Vos offres créées</h2>
            {% if offres_creees|length>0 %}
                {% for offre in offres_creees %}
                    <br/>
                    <div class="bloc">
                        <div class="info">
                            <p class="element"><strong class="G">Auteur:</strong> {{ offre[1] }}</p>
                            <p class="element"><strong class="G">Classe:</strong> {{ offre[2] }}</p>
                            <p class="element"><strong class="G">Matière:</strong> {{ offre[3] }}</p>
                            <p class="element"><strong class="G">Participants:</strong>
                                {% if offre[5] is none and offre[6] is none %}
                                    Aucun
                                {% else %}
                                    {% if offre[5] is not none %}{{ offre[5] }}{% endif %}{% if offre[6] is not none %},
                                        {{ offre[6] }}{% endif %}
                                {% endif %}
                            </p>
                            <p class="element"><strong class="G">Etat de l'offre:</strong> {% if offre[7]==0 %}En
                                attente de validation{% else %}Publiée{% endif %}</p>
                        </div>
                        <div id="horaires">
                            <div class="horaire">
                                <div class="table">
                                    {% for i in range(0,12,2) %}
                                        {% if offre[8+i] is not none and offre[9+i] is not none %}
                                            <p>{{ days[i//2] }}:</p>
                                        {% endif %}{% endfor %}
                                </div>
                                <div class="table" id="table_horaires">
                                    {% for i in range(0,12,2) %}
                                        {% if offre[8+i] is not none and offre[9+i] is not none %}
                                            <p>{{ 'h'.join((offre[8+i]|string).split(':')[:2]) }}
                                                - {{ 'h'.join((offre[9+i]|string).split(':')[:2]) }}</p>
                                        {% endif %}{% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="date">
                            <p class="time"><strong class="G">Publiée le:</strong> {{ offre[4].strftime('%d-%m-%Y') }}
                            </p>
                            <p class="supr_offre"><a href="/delete?id={{ offre[0] }}">
                                <button>Supprimer l'offre</button>
                            </a></p>
                        </div>
                    </div>
                    <br/>
                {% endfor %}
            {% else %}
                <div class="bloc" id="none_offre">
                    <p class="none_offre">Vous n'avez pas encore crée d'offre</p>
                    <p class="none_offre"><a href="/create">
                        <button>Créer une offre</button>
                    </a></p>
                </div>
            {% endif %}
        </div>
        <div class="offres" id="tutorat_en_cours">
            <!-- Liste des offres auxquelles participe l'utilisateur -->
            <h2>Les offres auxquelles vous participez</h2>
            {% if tutorats_actifs|length>0 %}
                {% for tutorat in tutorats_actifs %}
                    <br/>
                    <div class="bloc">
                        <div class="info">
                            <p class="element"><strong class="G">Auteur:</strong> {{ tutorat[1] }}</p>
                            <p class="element"><strong class="G">Mail de
                                l'auteur:</strong> {{ sql_obj.get_user_info(tutorat[1])[2] }}</p>
                            <p class="element"><strong class="G">Matière:</strong> {{ tutorat[3] }}</p>
                            <p class="element"><strong class="G">Participants:</strong>
                                {% if tutorat[5] is none and tutorat[6] is none %}
                                    Aucun
                                {% else %}
                                    {% if tutorat[5] is not none %}{{ tutorat[5] }}{% endif %}
                                    {% if tutorat[6] is not none %}, {{ tutorat[6] }}{% endif %}
                                {% endif %}
                            </p>
                        </div>
                        <div id="horaires">
                            <div class="horaire">
                                <div class="table">
                                    {% for i in range(0,12,2) %}
                                        {% if tutorat[8+i] is not none and tutorat[9+i] is not none %}
                                            <p>{{ days[i//2] }}:</p>
                                        {% endif %}{% endfor %}
                                </div>
                                <div class="table" id="table_horaires">
                                    {% for i in range(0,12,2) %}
                                        {% if tutorat[8+i] is not none and tutorat[9+i] is not none %}
                                            <p>{{ 'h'.join((tutorat[8+i]|string).split(':')[:2]) }}
                                                - {{ 'h'.join((tutorat[9+i]|string).split(':')[:2]) }}</p>
                                        {% endif %}{% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="date">
                            <p class="time"><strong class="G">Publiée le:</strong> {{ tutorat[4].strftime('%d-%m-%Y') }}
                            </p>
                            <p class="supr_offre"><a href="/quit?id={{ tutorat[0] }}">
                                <button>Quitter ce tutorat</button>
                            </a></p>
                        </div>
                    </div>
                    <br/>
                {% endfor %}
            {% else %}
                <div class="bloc" id="none_offre">
                    <p class="none_offre">Vous ne participez à aucun Tutorat</p>
                    <p class="none_offre"><a href="/search">
                        <button>Rechercher une offre</button>
                    </a></p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

{% include 'FOOTER.html' %}

</body>
</html>
